{
  "$schema": "https://tree-sitter.github.io/tree-sitter/assets/schemas/grammar.schema.json",
  "name": "oml",
  "word": "identifier",
  "rules": {
    "source_file": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "header"
        },
        {
          "type": "SYMBOL",
          "name": "separator"
        },
        {
          "type": "REPEAT",
          "content": {
            "type": "SYMBOL",
            "name": "static_block"
          }
        },
        {
          "type": "REPEAT",
          "content": {
            "type": "SYMBOL",
            "name": "aggregate_item"
          }
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SEQ",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "separator"
                },
                {
                  "type": "REPEAT",
                  "content": {
                    "type": "SYMBOL",
                    "name": "privacy_item"
                  }
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        }
      ]
    },
    "comment": {
      "type": "TOKEN",
      "content": {
        "type": "CHOICE",
        "members": [
          {
            "type": "SEQ",
            "members": [
              {
                "type": "STRING",
                "value": "#"
              },
              {
                "type": "PATTERN",
                "value": ".*"
              }
            ]
          },
          {
            "type": "SEQ",
            "members": [
              {
                "type": "STRING",
                "value": "//"
              },
              {
                "type": "PATTERN",
                "value": ".*"
              }
            ]
          }
        ]
      }
    },
    "separator": {
      "type": "STRING",
      "value": "---"
    },
    "header": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "name_field"
        },
        {
          "type": "REPEAT",
          "content": {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "rule_field"
              },
              {
                "type": "SYMBOL",
                "name": "enable_field"
              }
            ]
          }
        }
      ]
    },
    "name_field": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "name"
        },
        {
          "type": "STRING",
          "value": ":"
        },
        {
          "type": "FIELD",
          "name": "name",
          "content": {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "path"
              },
              {
                "type": "SYMBOL",
                "name": "identifier"
              }
            ]
          }
        }
      ]
    },
    "enable_field": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "enable"
        },
        {
          "type": "STRING",
          "value": ":"
        },
        {
          "type": "SYMBOL",
          "name": "boolean"
        }
      ]
    },
    "rule_field": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "rule"
        },
        {
          "type": "STRING",
          "value": ":"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "path"
            },
            {
              "type": "SYMBOL",
              "name": "identifier"
            }
          ]
        },
        {
          "type": "REPEAT",
          "content": {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "path"
              },
              {
                "type": "SYMBOL",
                "name": "identifier"
              }
            ]
          }
        }
      ]
    },
    "path": {
      "type": "TOKEN",
      "content": {
        "type": "PREC",
        "value": -1,
        "content": {
          "type": "PATTERN",
          "value": "[a-zA-Z_\\/][a-zA-Z0-9_.\\/\\-*]+"
        }
      }
    },
    "static_block": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "static"
        },
        {
          "type": "STRING",
          "value": "{"
        },
        {
          "type": "REPEAT1",
          "content": {
            "type": "SYMBOL",
            "name": "static_item"
          }
        },
        {
          "type": "STRING",
          "value": "}"
        }
      ]
    },
    "static_item": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "target"
        },
        {
          "type": "STRING",
          "value": "="
        },
        {
          "type": "SYMBOL",
          "name": "_eval"
        },
        {
          "type": "STRING",
          "value": ";"
        }
      ]
    },
    "aggregate_item": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "target_list"
        },
        {
          "type": "STRING",
          "value": "="
        },
        {
          "type": "SYMBOL",
          "name": "_eval"
        },
        {
          "type": "STRING",
          "value": ";"
        }
      ]
    },
    "target_list": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "target"
        },
        {
          "type": "REPEAT",
          "content": {
            "type": "SEQ",
            "members": [
              {
                "type": "STRING",
                "value": ","
              },
              {
                "type": "SYMBOL",
                "name": "target"
              }
            ]
          }
        }
      ]
    },
    "target": {
      "type": "SEQ",
      "members": [
        {
          "type": "FIELD",
          "name": "name",
          "content": {
            "type": "SYMBOL",
            "name": "target_name"
          }
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SEQ",
              "members": [
                {
                  "type": "STRING",
                  "value": ":"
                },
                {
                  "type": "FIELD",
                  "name": "type",
                  "content": {
                    "type": "SYMBOL",
                    "name": "data_type"
                  }
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        }
      ]
    },
    "target_name": {
      "type": "CHOICE",
      "members": [
        {
          "type": "STRING",
          "value": "_"
        },
        {
          "type": "SYMBOL",
          "name": "wild_key"
        },
        {
          "type": "SYMBOL",
          "name": "identifier"
        }
      ]
    },
    "wild_key": {
      "type": "TOKEN",
      "content": {
        "type": "PREC",
        "value": 1,
        "content": {
          "type": "PATTERN",
          "value": "\\*[a-zA-Z0-9_]*|[a-zA-Z_][a-zA-Z0-9_]*\\*"
        }
      }
    },
    "_eval": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SYMBOL",
          "name": "pipe_expr"
        },
        {
          "type": "SYMBOL",
          "name": "fmt_expr"
        },
        {
          "type": "SYMBOL",
          "name": "object_expr"
        },
        {
          "type": "SYMBOL",
          "name": "collect_expr"
        },
        {
          "type": "SYMBOL",
          "name": "match_expr"
        },
        {
          "type": "SYMBOL",
          "name": "sql_expr"
        },
        {
          "type": "SYMBOL",
          "name": "take_expr"
        },
        {
          "type": "SYMBOL",
          "name": "read_expr"
        },
        {
          "type": "SYMBOL",
          "name": "value_expr"
        },
        {
          "type": "SYMBOL",
          "name": "fun_call"
        },
        {
          "type": "SYMBOL",
          "name": "identifier"
        }
      ]
    },
    "take_expr": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "take"
        },
        {
          "type": "STRING",
          "value": "("
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "arg_list"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "STRING",
          "value": ")"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "default_body"
            },
            {
              "type": "BLANK"
            }
          ]
        }
      ]
    },
    "read_expr": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "read"
        },
        {
          "type": "STRING",
          "value": "("
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "arg_list"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "STRING",
          "value": ")"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "default_body"
            },
            {
              "type": "BLANK"
            }
          ]
        }
      ]
    },
    "arg_list": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "_arg"
        },
        {
          "type": "REPEAT",
          "content": {
            "type": "SEQ",
            "members": [
              {
                "type": "STRING",
                "value": ","
              },
              {
                "type": "SYMBOL",
                "name": "_arg"
              }
            ]
          }
        }
      ]
    },
    "_arg": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SYMBOL",
          "name": "option_arg"
        },
        {
          "type": "SYMBOL",
          "name": "keys_arg"
        },
        {
          "type": "SYMBOL",
          "name": "get_arg"
        },
        {
          "type": "SYMBOL",
          "name": "json_path"
        },
        {
          "type": "SYMBOL",
          "name": "path"
        },
        {
          "type": "SYMBOL",
          "name": "identifier"
        }
      ]
    },
    "option_arg": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "option"
        },
        {
          "type": "STRING",
          "value": ":"
        },
        {
          "type": "STRING",
          "value": "["
        },
        {
          "type": "SYMBOL",
          "name": "identifier"
        },
        {
          "type": "REPEAT",
          "content": {
            "type": "SEQ",
            "members": [
              {
                "type": "STRING",
                "value": ","
              },
              {
                "type": "SYMBOL",
                "name": "identifier"
              }
            ]
          }
        },
        {
          "type": "STRING",
          "value": "]"
        }
      ]
    },
    "keys_arg": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "STRING",
              "value": "in"
            },
            {
              "type": "STRING",
              "value": "keys"
            }
          ]
        },
        {
          "type": "STRING",
          "value": ":"
        },
        {
          "type": "STRING",
          "value": "["
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "wild_key"
            },
            {
              "type": "SYMBOL",
              "name": "identifier"
            }
          ]
        },
        {
          "type": "REPEAT",
          "content": {
            "type": "SEQ",
            "members": [
              {
                "type": "STRING",
                "value": ","
              },
              {
                "type": "CHOICE",
                "members": [
                  {
                    "type": "SYMBOL",
                    "name": "wild_key"
                  },
                  {
                    "type": "SYMBOL",
                    "name": "identifier"
                  }
                ]
              }
            ]
          }
        },
        {
          "type": "STRING",
          "value": "]"
        }
      ]
    },
    "get_arg": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "get"
        },
        {
          "type": "STRING",
          "value": ":"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "identifier"
            },
            {
              "type": "SYMBOL",
              "name": "number"
            },
            {
              "type": "SYMBOL",
              "name": "string"
            }
          ]
        }
      ]
    },
    "json_path": {
      "type": "TOKEN",
      "content": {
        "type": "PREC",
        "value": -1,
        "content": {
          "type": "PATTERN",
          "value": "\\/[a-zA-Z0-9_\\[\\].*][a-zA-Z0-9_\\[\\].\\/*]*"
        }
      }
    },
    "default_body": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "{"
        },
        {
          "type": "STRING",
          "value": "_"
        },
        {
          "type": "STRING",
          "value": ":"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "take_expr"
            },
            {
              "type": "SYMBOL",
              "name": "read_expr"
            },
            {
              "type": "SYMBOL",
              "name": "value_expr"
            },
            {
              "type": "SYMBOL",
              "name": "fun_call"
            },
            {
              "type": "SYMBOL",
              "name": "identifier"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "STRING",
              "value": ";"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "STRING",
          "value": "}"
        }
      ]
    },
    "value_expr": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "data_type"
        },
        {
          "type": "STRING",
          "value": "("
        },
        {
          "type": "SYMBOL",
          "name": "_literal"
        },
        {
          "type": "STRING",
          "value": ")"
        }
      ]
    },
    "data_type": {
      "type": "CHOICE",
      "members": [
        {
          "type": "STRING",
          "value": "auto"
        },
        {
          "type": "STRING",
          "value": "ip"
        },
        {
          "type": "STRING",
          "value": "chars"
        },
        {
          "type": "STRING",
          "value": "digit"
        },
        {
          "type": "STRING",
          "value": "float"
        },
        {
          "type": "STRING",
          "value": "time"
        },
        {
          "type": "STRING",
          "value": "bool"
        },
        {
          "type": "STRING",
          "value": "obj"
        },
        {
          "type": "STRING",
          "value": "array"
        },
        {
          "type": "STRING",
          "value": "time_iso"
        },
        {
          "type": "STRING",
          "value": "time_3339"
        },
        {
          "type": "STRING",
          "value": "time_2822"
        },
        {
          "type": "STRING",
          "value": "time_timestamp"
        },
        {
          "type": "STRING",
          "value": "time_clf"
        },
        {
          "type": "STRING",
          "value": "url"
        },
        {
          "type": "STRING",
          "value": "domain"
        },
        {
          "type": "STRING",
          "value": "ip_net"
        },
        {
          "type": "STRING",
          "value": "kv"
        },
        {
          "type": "STRING",
          "value": "json"
        },
        {
          "type": "STRING",
          "value": "base64"
        },
        {
          "type": "TOKEN",
          "content": {
            "type": "PREC",
            "value": 2,
            "content": {
              "type": "PATTERN",
              "value": "array\\/[a-zA-Z_]+"
            }
          }
        },
        {
          "type": "TOKEN",
          "content": {
            "type": "PREC",
            "value": 2,
            "content": {
              "type": "PATTERN",
              "value": "time\\/[a-zA-Z0-9]+"
            }
          }
        }
      ]
    },
    "fun_call": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "STRING",
              "value": "Now::time"
            },
            {
              "type": "STRING",
              "value": "Now::date"
            },
            {
              "type": "STRING",
              "value": "Now::hour"
            }
          ]
        },
        {
          "type": "STRING",
          "value": "("
        },
        {
          "type": "STRING",
          "value": ")"
        }
      ]
    },
    "fmt_expr": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "fmt"
        },
        {
          "type": "STRING",
          "value": "("
        },
        {
          "type": "SYMBOL",
          "name": "string"
        },
        {
          "type": "STRING",
          "value": ","
        },
        {
          "type": "SYMBOL",
          "name": "var_get"
        },
        {
          "type": "REPEAT",
          "content": {
            "type": "SEQ",
            "members": [
              {
                "type": "STRING",
                "value": ","
              },
              {
                "type": "SYMBOL",
                "name": "var_get"
              }
            ]
          }
        },
        {
          "type": "STRING",
          "value": ")"
        }
      ]
    },
    "var_get": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SEQ",
          "members": [
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "STRING",
                  "value": "read"
                },
                {
                  "type": "STRING",
                  "value": "take"
                }
              ]
            },
            {
              "type": "STRING",
              "value": "("
            },
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "arg_list"
                },
                {
                  "type": "BLANK"
                }
              ]
            },
            {
              "type": "STRING",
              "value": ")"
            }
          ]
        },
        {
          "type": "SYMBOL",
          "name": "at_ref"
        }
      ]
    },
    "at_ref": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "@"
        },
        {
          "type": "SYMBOL",
          "name": "identifier"
        }
      ]
    },
    "pipe_expr": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "STRING",
              "value": "pipe"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "SYMBOL",
          "name": "var_get"
        },
        {
          "type": "STRING",
          "value": "|"
        },
        {
          "type": "SYMBOL",
          "name": "pipe_fun"
        },
        {
          "type": "REPEAT",
          "content": {
            "type": "SEQ",
            "members": [
              {
                "type": "STRING",
                "value": "|"
              },
              {
                "type": "SYMBOL",
                "name": "pipe_fun"
              }
            ]
          }
        }
      ]
    },
    "pipe_fun": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SEQ",
          "members": [
            {
              "type": "STRING",
              "value": "nth"
            },
            {
              "type": "STRING",
              "value": "("
            },
            {
              "type": "SYMBOL",
              "name": "number"
            },
            {
              "type": "STRING",
              "value": ")"
            }
          ]
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "STRING",
              "value": "get"
            },
            {
              "type": "STRING",
              "value": "("
            },
            {
              "type": "SYMBOL",
              "name": "identifier"
            },
            {
              "type": "REPEAT",
              "content": {
                "type": "SEQ",
                "members": [
                  {
                    "type": "STRING",
                    "value": "/"
                  },
                  {
                    "type": "SYMBOL",
                    "name": "identifier"
                  }
                ]
              }
            },
            {
              "type": "STRING",
              "value": ")"
            }
          ]
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "STRING",
              "value": "base64_decode"
            },
            {
              "type": "STRING",
              "value": "("
            },
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "identifier"
                },
                {
                  "type": "BLANK"
                }
              ]
            },
            {
              "type": "STRING",
              "value": ")"
            }
          ]
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "STRING",
              "value": "path"
            },
            {
              "type": "STRING",
              "value": "("
            },
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "STRING",
                  "value": "name"
                },
                {
                  "type": "STRING",
                  "value": "path"
                }
              ]
            },
            {
              "type": "STRING",
              "value": ")"
            }
          ]
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "STRING",
              "value": "url"
            },
            {
              "type": "STRING",
              "value": "("
            },
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "STRING",
                  "value": "domain"
                },
                {
                  "type": "STRING",
                  "value": "host"
                },
                {
                  "type": "STRING",
                  "value": "uri"
                },
                {
                  "type": "STRING",
                  "value": "path"
                },
                {
                  "type": "STRING",
                  "value": "params"
                }
              ]
            },
            {
              "type": "STRING",
              "value": ")"
            }
          ]
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "STRING",
              "value": "Time::to_ts_zone"
            },
            {
              "type": "STRING",
              "value": "("
            },
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "STRING",
                  "value": "-"
                },
                {
                  "type": "BLANK"
                }
              ]
            },
            {
              "type": "SYMBOL",
              "name": "number"
            },
            {
              "type": "STRING",
              "value": ","
            },
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "STRING",
                  "value": "ms"
                },
                {
                  "type": "STRING",
                  "value": "us"
                },
                {
                  "type": "STRING",
                  "value": "ss"
                },
                {
                  "type": "STRING",
                  "value": "s"
                }
              ]
            },
            {
              "type": "STRING",
              "value": ")"
            }
          ]
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "STRING",
              "value": "starts_with"
            },
            {
              "type": "STRING",
              "value": "("
            },
            {
              "type": "SYMBOL",
              "name": "string"
            },
            {
              "type": "STRING",
              "value": ")"
            }
          ]
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "STRING",
              "value": "map_to"
            },
            {
              "type": "STRING",
              "value": "("
            },
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "string"
                },
                {
                  "type": "SYMBOL",
                  "name": "number"
                },
                {
                  "type": "SYMBOL",
                  "name": "boolean"
                }
              ]
            },
            {
              "type": "STRING",
              "value": ")"
            }
          ]
        },
        {
          "type": "STRING",
          "value": "base64_encode"
        },
        {
          "type": "STRING",
          "value": "html_escape"
        },
        {
          "type": "STRING",
          "value": "html_unescape"
        },
        {
          "type": "STRING",
          "value": "str_escape"
        },
        {
          "type": "STRING",
          "value": "json_escape"
        },
        {
          "type": "STRING",
          "value": "json_unescape"
        },
        {
          "type": "STRING",
          "value": "Time::to_ts"
        },
        {
          "type": "STRING",
          "value": "Time::to_ts_ms"
        },
        {
          "type": "STRING",
          "value": "Time::to_ts_us"
        },
        {
          "type": "STRING",
          "value": "to_json"
        },
        {
          "type": "STRING",
          "value": "to_str"
        },
        {
          "type": "STRING",
          "value": "skip_empty"
        },
        {
          "type": "STRING",
          "value": "ip4_to_int"
        },
        {
          "type": "STRING",
          "value": "extract_main_word"
        },
        {
          "type": "STRING",
          "value": "extract_subject_object"
        }
      ]
    },
    "object_expr": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "object"
        },
        {
          "type": "STRING",
          "value": "{"
        },
        {
          "type": "REPEAT1",
          "content": {
            "type": "SYMBOL",
            "name": "map_item"
          }
        },
        {
          "type": "STRING",
          "value": "}"
        }
      ]
    },
    "map_item": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "map_targets"
        },
        {
          "type": "STRING",
          "value": "="
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "take_expr"
            },
            {
              "type": "SYMBOL",
              "name": "read_expr"
            },
            {
              "type": "SYMBOL",
              "name": "value_expr"
            },
            {
              "type": "SYMBOL",
              "name": "fun_call"
            },
            {
              "type": "SYMBOL",
              "name": "identifier"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "STRING",
              "value": ";"
            },
            {
              "type": "BLANK"
            }
          ]
        }
      ]
    },
    "map_targets": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "identifier"
        },
        {
          "type": "REPEAT",
          "content": {
            "type": "SEQ",
            "members": [
              {
                "type": "STRING",
                "value": ","
              },
              {
                "type": "SYMBOL",
                "name": "identifier"
              }
            ]
          }
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SEQ",
              "members": [
                {
                  "type": "STRING",
                  "value": ":"
                },
                {
                  "type": "SYMBOL",
                  "name": "data_type"
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        }
      ]
    },
    "collect_expr": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "collect"
        },
        {
          "type": "SYMBOL",
          "name": "var_get"
        }
      ]
    },
    "match_expr": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SEQ",
          "members": [
            {
              "type": "STRING",
              "value": "match"
            },
            {
              "type": "SYMBOL",
              "name": "var_get"
            },
            {
              "type": "STRING",
              "value": "{"
            },
            {
              "type": "REPEAT1",
              "content": {
                "type": "SYMBOL",
                "name": "case_arm"
              }
            },
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "default_arm"
                },
                {
                  "type": "BLANK"
                }
              ]
            },
            {
              "type": "STRING",
              "value": "}"
            }
          ]
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "STRING",
              "value": "match"
            },
            {
              "type": "STRING",
              "value": "("
            },
            {
              "type": "SYMBOL",
              "name": "var_get"
            },
            {
              "type": "REPEAT1",
              "content": {
                "type": "SEQ",
                "members": [
                  {
                    "type": "STRING",
                    "value": ","
                  },
                  {
                    "type": "SYMBOL",
                    "name": "var_get"
                  }
                ]
              }
            },
            {
              "type": "STRING",
              "value": ")"
            },
            {
              "type": "STRING",
              "value": "{"
            },
            {
              "type": "REPEAT1",
              "content": {
                "type": "SYMBOL",
                "name": "multi_case_arm"
              }
            },
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "default_arm"
                },
                {
                  "type": "BLANK"
                }
              ]
            },
            {
              "type": "STRING",
              "value": "}"
            }
          ]
        }
      ]
    },
    "case_arm": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "condition"
        },
        {
          "type": "STRING",
          "value": "=>"
        },
        {
          "type": "SYMBOL",
          "name": "_calc"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "STRING",
              "value": ","
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "STRING",
              "value": ";"
            },
            {
              "type": "BLANK"
            }
          ]
        }
      ]
    },
    "multi_case_arm": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "("
        },
        {
          "type": "SYMBOL",
          "name": "condition"
        },
        {
          "type": "REPEAT1",
          "content": {
            "type": "SEQ",
            "members": [
              {
                "type": "STRING",
                "value": ","
              },
              {
                "type": "SYMBOL",
                "name": "condition"
              }
            ]
          }
        },
        {
          "type": "STRING",
          "value": ")"
        },
        {
          "type": "STRING",
          "value": "=>"
        },
        {
          "type": "SYMBOL",
          "name": "_calc"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "STRING",
              "value": ","
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "STRING",
              "value": ";"
            },
            {
              "type": "BLANK"
            }
          ]
        }
      ]
    },
    "default_arm": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "_"
        },
        {
          "type": "STRING",
          "value": "=>"
        },
        {
          "type": "SYMBOL",
          "name": "_calc"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "STRING",
              "value": ","
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "STRING",
              "value": ";"
            },
            {
              "type": "BLANK"
            }
          ]
        }
      ]
    },
    "_calc": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SYMBOL",
          "name": "read_expr"
        },
        {
          "type": "SYMBOL",
          "name": "take_expr"
        },
        {
          "type": "SYMBOL",
          "name": "value_expr"
        },
        {
          "type": "SYMBOL",
          "name": "collect_expr"
        },
        {
          "type": "SYMBOL",
          "name": "identifier"
        }
      ]
    },
    "condition": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "_cond_atom"
        },
        {
          "type": "REPEAT",
          "content": {
            "type": "SEQ",
            "members": [
              {
                "type": "STRING",
                "value": "|"
              },
              {
                "type": "SYMBOL",
                "name": "_cond_atom"
              }
            ]
          }
        }
      ]
    },
    "_cond_atom": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SYMBOL",
          "name": "in_condition"
        },
        {
          "type": "SYMBOL",
          "name": "not_condition"
        },
        {
          "type": "SYMBOL",
          "name": "match_fun"
        },
        {
          "type": "SYMBOL",
          "name": "value_expr"
        }
      ]
    },
    "in_condition": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "in"
        },
        {
          "type": "STRING",
          "value": "("
        },
        {
          "type": "SYMBOL",
          "name": "value_expr"
        },
        {
          "type": "STRING",
          "value": ","
        },
        {
          "type": "SYMBOL",
          "name": "value_expr"
        },
        {
          "type": "STRING",
          "value": ")"
        }
      ]
    },
    "not_condition": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "!"
        },
        {
          "type": "SYMBOL",
          "name": "value_expr"
        }
      ]
    },
    "match_fun": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SEQ",
          "members": [
            {
              "type": "STRING",
              "value": "starts_with"
            },
            {
              "type": "STRING",
              "value": "("
            },
            {
              "type": "SYMBOL",
              "name": "string"
            },
            {
              "type": "STRING",
              "value": ")"
            }
          ]
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "STRING",
              "value": "ends_with"
            },
            {
              "type": "STRING",
              "value": "("
            },
            {
              "type": "SYMBOL",
              "name": "string"
            },
            {
              "type": "STRING",
              "value": ")"
            }
          ]
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "STRING",
              "value": "contains"
            },
            {
              "type": "STRING",
              "value": "("
            },
            {
              "type": "SYMBOL",
              "name": "string"
            },
            {
              "type": "STRING",
              "value": ")"
            }
          ]
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "STRING",
              "value": "regex_match"
            },
            {
              "type": "STRING",
              "value": "("
            },
            {
              "type": "SYMBOL",
              "name": "string"
            },
            {
              "type": "STRING",
              "value": ")"
            }
          ]
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "STRING",
              "value": "iequals"
            },
            {
              "type": "STRING",
              "value": "("
            },
            {
              "type": "SYMBOL",
              "name": "string"
            },
            {
              "type": "STRING",
              "value": ")"
            }
          ]
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "STRING",
              "value": "is_empty"
            },
            {
              "type": "STRING",
              "value": "("
            },
            {
              "type": "STRING",
              "value": ")"
            }
          ]
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "STRING",
              "value": "gt"
            },
            {
              "type": "STRING",
              "value": "("
            },
            {
              "type": "SYMBOL",
              "name": "number"
            },
            {
              "type": "STRING",
              "value": ")"
            }
          ]
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "STRING",
              "value": "lt"
            },
            {
              "type": "STRING",
              "value": "("
            },
            {
              "type": "SYMBOL",
              "name": "number"
            },
            {
              "type": "STRING",
              "value": ")"
            }
          ]
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "STRING",
              "value": "eq"
            },
            {
              "type": "STRING",
              "value": "("
            },
            {
              "type": "SYMBOL",
              "name": "number"
            },
            {
              "type": "STRING",
              "value": ")"
            }
          ]
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "STRING",
              "value": "in_range"
            },
            {
              "type": "STRING",
              "value": "("
            },
            {
              "type": "SYMBOL",
              "name": "number"
            },
            {
              "type": "STRING",
              "value": ","
            },
            {
              "type": "SYMBOL",
              "name": "number"
            },
            {
              "type": "STRING",
              "value": ")"
            }
          ]
        }
      ]
    },
    "sql_expr": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "select"
        },
        {
          "type": "SYMBOL",
          "name": "sql_columns"
        },
        {
          "type": "STRING",
          "value": "from"
        },
        {
          "type": "SYMBOL",
          "name": "identifier"
        },
        {
          "type": "STRING",
          "value": "where"
        },
        {
          "type": "SYMBOL",
          "name": "sql_condition"
        }
      ]
    },
    "sql_columns": {
      "type": "CHOICE",
      "members": [
        {
          "type": "STRING",
          "value": "*"
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "SYMBOL",
              "name": "identifier"
            },
            {
              "type": "REPEAT",
              "content": {
                "type": "SEQ",
                "members": [
                  {
                    "type": "STRING",
                    "value": ","
                  },
                  {
                    "type": "SYMBOL",
                    "name": "identifier"
                  }
                ]
              }
            }
          ]
        }
      ]
    },
    "sql_condition": {
      "type": "PREC_LEFT",
      "value": 0,
      "content": {
        "type": "SEQ",
        "members": [
          {
            "type": "SYMBOL",
            "name": "_sql_term"
          },
          {
            "type": "REPEAT",
            "content": {
              "type": "SEQ",
              "members": [
                {
                  "type": "CHOICE",
                  "members": [
                    {
                      "type": "STRING",
                      "value": "and"
                    },
                    {
                      "type": "STRING",
                      "value": "or"
                    }
                  ]
                },
                {
                  "type": "SYMBOL",
                  "name": "_sql_term"
                }
              ]
            }
          }
        ]
      }
    },
    "_sql_term": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SYMBOL",
          "name": "sql_comparison"
        },
        {
          "type": "SYMBOL",
          "name": "sql_not"
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "STRING",
              "value": "("
            },
            {
              "type": "SYMBOL",
              "name": "sql_condition"
            },
            {
              "type": "STRING",
              "value": ")"
            }
          ]
        }
      ]
    },
    "sql_comparison": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "identifier"
        },
        {
          "type": "SYMBOL",
          "name": "sql_op"
        },
        {
          "type": "SYMBOL",
          "name": "_sql_rhs"
        }
      ]
    },
    "sql_op": {
      "type": "CHOICE",
      "members": [
        {
          "type": "STRING",
          "value": "="
        },
        {
          "type": "STRING",
          "value": "!="
        },
        {
          "type": "STRING",
          "value": "<"
        },
        {
          "type": "STRING",
          "value": ">"
        },
        {
          "type": "STRING",
          "value": "<="
        },
        {
          "type": "STRING",
          "value": ">="
        }
      ]
    },
    "_sql_rhs": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SYMBOL",
          "name": "sql_fun_call"
        },
        {
          "type": "SYMBOL",
          "name": "read_expr"
        },
        {
          "type": "SYMBOL",
          "name": "take_expr"
        },
        {
          "type": "SYMBOL",
          "name": "fun_call"
        },
        {
          "type": "SYMBOL",
          "name": "string"
        },
        {
          "type": "SYMBOL",
          "name": "number"
        }
      ]
    },
    "sql_fun_call": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "identifier"
        },
        {
          "type": "STRING",
          "value": "("
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "read_expr"
            },
            {
              "type": "SYMBOL",
              "name": "take_expr"
            },
            {
              "type": "SYMBOL",
              "name": "fun_call"
            },
            {
              "type": "SYMBOL",
              "name": "string"
            },
            {
              "type": "SYMBOL",
              "name": "number"
            },
            {
              "type": "SYMBOL",
              "name": "identifier"
            }
          ]
        },
        {
          "type": "STRING",
          "value": ")"
        }
      ]
    },
    "sql_not": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "not"
        },
        {
          "type": "SYMBOL",
          "name": "sql_condition"
        }
      ]
    },
    "privacy_item": {
      "type": "SEQ",
      "members": [
        {
          "type": "FIELD",
          "name": "name",
          "content": {
            "type": "SYMBOL",
            "name": "identifier"
          }
        },
        {
          "type": "STRING",
          "value": ":"
        },
        {
          "type": "FIELD",
          "name": "type",
          "content": {
            "type": "SYMBOL",
            "name": "privacy_type"
          }
        }
      ]
    },
    "privacy_type": {
      "type": "CHOICE",
      "members": [
        {
          "type": "STRING",
          "value": "privacy_ip"
        },
        {
          "type": "STRING",
          "value": "privacy_specify_ip"
        },
        {
          "type": "STRING",
          "value": "privacy_id_card"
        },
        {
          "type": "STRING",
          "value": "privacy_mobile"
        },
        {
          "type": "STRING",
          "value": "privacy_mail"
        },
        {
          "type": "STRING",
          "value": "privacy_domain"
        },
        {
          "type": "STRING",
          "value": "privacy_specify_name"
        },
        {
          "type": "STRING",
          "value": "privacy_specify_domain"
        },
        {
          "type": "STRING",
          "value": "privacy_specify_address"
        },
        {
          "type": "STRING",
          "value": "privacy_specify_company"
        },
        {
          "type": "STRING",
          "value": "privacy_keymsg"
        }
      ]
    },
    "_literal": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SYMBOL",
          "name": "string"
        },
        {
          "type": "SYMBOL",
          "name": "number"
        },
        {
          "type": "SYMBOL",
          "name": "ip_literal"
        },
        {
          "type": "SYMBOL",
          "name": "boolean"
        },
        {
          "type": "SYMBOL",
          "name": "identifier"
        },
        {
          "type": "SYMBOL",
          "name": "path"
        }
      ]
    },
    "string": {
      "type": "TOKEN",
      "content": {
        "type": "CHOICE",
        "members": [
          {
            "type": "SEQ",
            "members": [
              {
                "type": "STRING",
                "value": "\""
              },
              {
                "type": "REPEAT",
                "content": {
                  "type": "CHOICE",
                  "members": [
                    {
                      "type": "PATTERN",
                      "value": "[^\"\\\\]"
                    },
                    {
                      "type": "PATTERN",
                      "value": "\\\\."
                    }
                  ]
                }
              },
              {
                "type": "STRING",
                "value": "\""
              }
            ]
          },
          {
            "type": "SEQ",
            "members": [
              {
                "type": "STRING",
                "value": "'"
              },
              {
                "type": "REPEAT",
                "content": {
                  "type": "CHOICE",
                  "members": [
                    {
                      "type": "PATTERN",
                      "value": "[^'\\\\]"
                    },
                    {
                      "type": "PATTERN",
                      "value": "\\\\."
                    }
                  ]
                }
              },
              {
                "type": "STRING",
                "value": "'"
              }
            ]
          }
        ]
      }
    },
    "number": {
      "type": "TOKEN",
      "content": {
        "type": "PATTERN",
        "value": "[0-9]+(\\.[0-9]+)?"
      }
    },
    "ip_literal": {
      "type": "TOKEN",
      "content": {
        "type": "PATTERN",
        "value": "[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+"
      }
    },
    "boolean": {
      "type": "CHOICE",
      "members": [
        {
          "type": "STRING",
          "value": "true"
        },
        {
          "type": "STRING",
          "value": "false"
        }
      ]
    },
    "identifier": {
      "type": "PATTERN",
      "value": "[a-zA-Z_][a-zA-Z0-9_]*"
    }
  },
  "extras": [
    {
      "type": "PATTERN",
      "value": "\\s"
    },
    {
      "type": "SYMBOL",
      "name": "comment"
    }
  ],
  "conflicts": [],
  "precedences": [],
  "externals": [],
  "inline": [],
  "supertypes": [],
  "reserved": {}
}